package Principal;

import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.net.http.HttpResponse.BodyHandlers;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

import com.google.gson.Gson;

import br.com.buscacep.modelo.Endereco;

public class Main {

	public static void main(String[] args) throws IOException, InterruptedException {
		
		int cep = 1;
		Scanner escaneador = new Scanner(System.in);
		HttpClient client = HttpClient.newHttpClient();
		List<Endereco> listaEndereco = new ArrayList<Endereco>();
		
		while (cep != 0) {
			System.out.println("Insira o cep que deseja buscar (00000000): ");
			cep = escaneador.nextInt();
			
			HttpRequest req = HttpRequest.newBuilder()
					 .uri(URI.create("https://viacep.com.br/ws/"+ cep +"/json/"))
					 .build();
			
			HttpResponse<String> res = client.send(req, HttpResponse.BodyHandlers.ofString());
			System.out.println("\n Response body: " + res.body());
			System.out.println("\n Response String: " + res.toString());
			
			
			Gson gson = new Gson();
			Endereco novoEndereco = gson.fromJson(res.body(), Endereco.class);
			
			System.out.println(novoEndereco.toString());
		}

	}

}
